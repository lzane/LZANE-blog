---
title: "Reactäº‹ä»¶ç³»ç»Ÿå’Œæºç æµ…æ"
date: 2018-11-03T20:00:00+08:00
draft: false
tags:
- Tech
- Front-end
- React
---

## TL;DR
æœ¬æ–‡é€šè¿‡å¯¹Reactäº‹ä»¶ç³»ç»Ÿå’Œæºç è¿›è¡Œæµ…æï¼Œå›ç­”â€œä¸ºä»€ä¹ˆReactéœ€è¦è‡ªå·±å®ç°ä¸€å¥—äº‹ä»¶ç³»ç»Ÿï¼Ÿâ€å’Œâ€œReactçš„äº‹ä»¶ç³»ç»Ÿæ˜¯æ€ä¹ˆè¿ä½œèµ·æ¥çš„ï¼Ÿâ€ä¸¤ä¸ªé—®é¢˜ã€‚Reactä¸ºäº†æ€§èƒ½å’Œå¤ç”¨ï¼Œé‡‡ç”¨äº†äº‹ä»¶ä»£ç†ï¼Œæ± ï¼Œæ‰¹é‡æ›´æ–°ï¼Œè·¨æµè§ˆå™¨å’Œè·¨å¹³å°å…¼å®¹ç­‰æ€æƒ³ï¼Œå°†äº‹ä»¶ç›‘å¬æŒ‚è½½åœ¨documentä¸Šï¼Œæ„é€ åˆæˆäº‹ä»¶ï¼Œå¹¶ä¸”åœ¨å†…éƒ¨æ¨¡æ‹Ÿäº†ä¸€å¥—æ•è·å’Œå†’æ³¡å¹¶è§¦å‘å›è°ƒå‡½æ•°çš„æœºåˆ¶ï¼Œå®ç°äº†è‡ªå·±çš„ä¸€å¥—äº‹ä»¶ç³»ç»Ÿã€‚

![åŠ¨å›¾](https://qncdnssl.lzane.com/2018-11-04-ccc.gif)

- å¦‚æœä½ åªæœ‰å‡ åˆ†é’Ÿï¼Œå»ºè®®ä½ ç›´æ¥çœ‹[åŠ¨ç”»éƒ¨åˆ†](#äº‹ä»¶è§¦å‘)ã€‚
- å¦‚æœä½ æœ‰åŠä¸ªå°æ—¶ï¼Œä½ å¯ä»¥æŒ‰é¡ºåºå¾€ä¸‹é˜…è¯»ï¼Œå¿½ç•¥æºç éƒ¨åˆ†ã€‚
- å¦‚æœä½ å¯¹Reactäº‹ä»¶ç³»ç»Ÿæœ‰è¾ƒå¤§çš„å…´è¶£ï¼Œé‚£ä¹ˆæ¨èä½ cloneä¸€ä»½Reactçš„æºç (æœ¬æ–‡åˆ—ä¸¾çš„æºç æ¥è‡ª[v16.5.0](https://github.com/facebook/react/tree/v16.5.0)),ç„¶åæŒ‰ç…§é¡ºåºä¾æ¬¡å¾€ä¸‹é˜…è¯»ã€‚


## å¼€å§‹

æœ€è¿‘åœ¨ä½¿ç”¨Reactå¯¹é¡¹ç›®å‰ç«¯è¿›è¡Œé‡æ„çš„æ—¶å€™ï¼Œè‡ªå·±å’ŒåŒäº‹é‡åˆ°äº†ä¸€äº›å¥‡æ€ªçš„é—®é¢˜ã€‚æ‰€ä»¥èŠ±äº†ä¸€äº›æ—¶é—´å¯¹Reactæºç è¿›è¡Œäº†ç ”ç©¶ï¼Œæ­¤ç¯‡çš„ä¸»é¢˜ä¸ºReactäº‹ä»¶ç³»ç»Ÿï¼Œå°½é‡å‰”é™¤å¤æ‚çš„æŠ€æœ¯ç»†èŠ‚ï¼Œå¸Œæœ›èƒ½ä»¥ç®€å•ç›´è§‚çš„æ–¹å¼å›ç­”ä¸¤ä¸ªé—®é¢˜ï¼Œåˆ†åˆ«æ˜¯**â€œä¸ºä»€ä¹ˆReactéœ€è¦è‡ªå·±å®ç°ä¸€å¥—äº‹ä»¶ç³»ç»Ÿï¼Ÿâ€**å’Œ**â€œReactçš„äº‹ä»¶ç³»ç»Ÿæ˜¯æ€ä¹ˆè¿ä½œèµ·æ¥çš„ï¼Ÿâ€**ã€‚

> Stuff can sometimes get surprisingly messy if you donâ€™t know how itÂ worksâ€¦


## ä¸¤ä¸ªç®€å•çš„ä¾‹å­

### ä¾‹å­ä¸€

1. æ ¹æ®ä¸‹é¢ä»£ç ï¼Œç‚¹å‡»æŒ‰é’®ä¹‹åï¼Œè¾“å‡ºç»“æœä¼šæ˜¯ä»€ä¹ˆï¼Ÿ(ABCDæ’åº)

2. å¦‚æœæˆ‘æŠŠ`innerClick`ä¸­çš„`e.stopPropagation()`åŠ ä¸Šï¼Œè¾“å‡ºç»“æœåˆä¼šæ˜¯ä»€ä¹ˆï¼Ÿ(ABCDæ’åº)

<a href="https://codesandbox.io/s/14vwm6jw44" target="_blank">
  <img alt="Edit Reactäº‹ä»¶å†’æ³¡ä¾‹å­" src="https://codesandbox.io/static/img/play-codesandbox.svg">
</a>


```js
class App extends React.Component {
  innerClick = e => {
    console.log("A: react inner click.");
    // e.stopPropagation();
  };

  outerClick = () => {
    console.log("B: react outer click.");
  };

  componentDidMount() {
    document
      .getElementById("outer")
      .addEventListener("click", () => console.log("C: native outer click"));

    window.addEventListener("click", () =>
      console.log("D: native window click")
    );
  }

  render() {
    return (
      <div id="outer" onClick={this.outerClick}>
        <button id="inner" onClick={this.innerClick}>
          BUTTON
        </button>
      </div>
    );
  }
}
```

æ­£ç¡®ç­”æ¡ˆæ˜¯(é˜²æ­¢ä½ ä»¬å·çœ‹ï¼Œè¯·å‘å·¦æ»‘åŠ¨ <â€”â€”   )ï¼š

```shell
                                                                                            1. 
                                                                                                C: native outer click 
                                                                                                A: react inner click. 
                                                                                                B: react outer click. 
                                                                                                D: native window click 
                                                                                            2.
                                                                                                C: native outer click 
                                                                                                A: react inner click.
```

### ä¾‹å­äºŒ

ä¸€ä¸ªè¡¨å•ï¼Œé¢„æœŸä¸ºéœ€è¦ç‚¹å‡»æŒ‰é’®editä¹‹åæ‰å¯ä»¥è¿›è¡Œç¼–è¾‘ï¼Œå¹¶ä¸”æ­¤æ—¶EditæŒ‰é’®å˜ä¸ºsubmitæŒ‰é’®ï¼Œç‚¹å‡»submitæŒ‰é’®æäº¤è¡¨å•ã€‚ä»£ç å¦‚ä¸‹

<a href="https://codesandbox.io/s/yj0z7169l9" target="_blank">
  <img alt="Edit yj0z7169l9" src="https://codesandbox.io/static/img/play-codesandbox.svg">
</a>

```js
class App extends React.Component {
  constructor(props) {
    super(props);
    this.state = {
      editable: false
    };
  }
  handleClick = () => {
    console.log("edit button click!!");
    this.setState({ editable: true });
  };
  handleSubmit = e => {
    console.log("submit event!!");
    e.preventDefault(); //é¿å…é¡µé¢åˆ·æ–°
  };
  render() {
    return (
      <form onSubmit={this.handleSubmit}>
        {this.state.editable ? (
          <button type="submit">submit</button>
        ) : (
          <button type="button" onClick={this.handleClick}>edit</button>
        )}
      </form>
    );
  }
}
```

ä½†å®é™…ä¸Šæˆ‘ä»¬å‘ç°ï¼Œç‚¹å‡»editæŒ‰é’®çš„æ—¶å€™å°±å·²ç»è§¦å‘formçš„submitäº‹ä»¶äº†ã€‚ä¸ºä»€ä¹ˆæˆ‘ä»¬ç‚¹å‡»äº†ä¸€ä¸ª`type="button"`çš„æŒ‰é’®ä¼šè§¦å‘`submit`äº‹ä»¶å‘¢ï¼Ÿ


å¸¦ç€å¯¹è¿™ä¸¤ä¸ªä¾‹å­çš„æ€è€ƒï¼Œæˆ‘ä»¬è¿›å…¥åˆ°æœ¬æ–‡çš„ä¸»é¢˜ã€‚[æˆ‘åªæƒ³ç›´æ¥çœ‹ç­”æ¡ˆï¼Ÿ](#ä¾‹å­debug)

## Reactä¸ºä»€ä¹ˆè¦è‡ªå·±å®ç°ä¸€ä¸ªäº‹ä»¶ç³»ç»Ÿï¼Ÿ

![reactäº‹ä»¶ppt.004](https://qncdnssl.lzane.com/2018-11-04-react%E4%BA%8B%E4%BB%B6ppt.004.jpeg)

æˆ‘è®¤ä¸ºè¿™ä¸ªé—®é¢˜ä¸»è¦æ˜¯ä¸ºäº†**æ€§èƒ½**å’Œ**å¤ç”¨**ä¸¤ä¸ªæ–¹é¢æ¥è€ƒè™‘ã€‚

é¦–å…ˆå¯¹äºæ€§èƒ½æ¥è¯´ï¼ŒReactä½œä¸ºä¸€å¥—Viewå±‚é¢çš„æ¡†æ¶ï¼Œé€šè¿‡æ¸²æŸ“å¾—åˆ°vDOMï¼Œå†ç”±diffç®—æ³•å†³å®šDOMæ ‘é‚£äº›ç»“ç‚¹éœ€è¦æ–°å¢ã€æ›¿æ¢æˆ–ä¿®æ”¹ï¼Œå‡å¦‚ç›´æ¥åœ¨DOMç»“ç‚¹æ’å…¥åŸç”Ÿäº‹ä»¶ç›‘å¬ï¼Œåˆ™ä¼šå¯¼è‡´é¢‘ç¹çš„è°ƒç”¨`addEventListener`å’Œ`removeEventListener`ï¼Œé€ æˆæ€§èƒ½çš„æµªè´¹ã€‚æ‰€ä»¥Reacté‡‡ç”¨äº†**äº‹ä»¶ä»£ç†**çš„æ–¹æ³•ï¼Œå¯¹äºå¤§éƒ¨åˆ†äº‹ä»¶[^propagation_document]è€Œè¨€éƒ½åœ¨documentä¸Šåšç›‘å¬ï¼Œç„¶åæ ¹æ®Eventä¸­çš„targetæ¥åˆ¤æ–­äº‹ä»¶è§¦å‘çš„ç»“ç‚¹ã€‚

å…¶æ¬¡Reactåˆæˆçš„`SyntheticEvent`é‡‡ç”¨äº†**æ± **çš„æ€æƒ³ï¼Œä»è€Œè¾¾åˆ°èŠ‚çº¦å†…å­˜ï¼Œé¿å…é¢‘ç¹çš„åˆ›å»ºå’Œé”€æ¯äº‹ä»¶å¯¹è±¡çš„ç›®çš„ã€‚è¿™ä¹Ÿæ˜¯å¦‚æœæˆ‘ä»¬éœ€è¦å¼‚æ­¥ä½¿ç”¨ä¸€ä¸ª`syntheticEvent`ï¼Œéœ€è¦æ‰§è¡Œ`event.persist()`æ‰èƒ½é˜²æ­¢äº‹ä»¶å¯¹è±¡è¢«é‡Šæ”¾çš„åŸå› ã€‚

æœ€ååœ¨Reactæºç ä¸­éšå¤„å¯è§batchåš**æ‰¹é‡æ›´æ–°**ï¼ŒåŸºæœ¬ä¸Šå‡¡æ˜¯å¯ä»¥æ‰¹é‡å¤„ç†çš„äº‹æƒ…ï¼ˆæœ€æ™®éçš„`setState`ï¼‰Reactéƒ½ä¼šå°†ä¸­é—´è¿‡ç¨‹ä¿å­˜èµ·æ¥ï¼Œç•™åˆ°æœ€åé¢æ‰flushæ‰ã€‚å°±å¦‚æµè§ˆå™¨å¯¹DOMæ ‘è¿›è¡ŒStyleï¼ŒLayoutï¼ŒPaintä¸€æ ·ï¼Œéƒ½ä¸ä¼šåœ¨æ“ä½œ`ele.style.color='red';`ä¹‹åé©¬ä¸Šæ‰§è¡Œï¼Œåªä¼šå°†è¿™äº›æ“ä½œæ‰“åŒ…èµ·æ¥å¹¶æœ€ç»ˆåœ¨éœ€è¦æ¸²æŸ“çš„æ—¶å€™å†åšæ¸²æŸ“ã€‚

```js
ele.style.color='red'; 
ele.style.color='blue';
ele.style.color='red';
æµè§ˆå™¨åªä¼šæ¸²æŸ“ä¸€æ¬¡
```

è€Œå¯¹äºå¤ç”¨æ¥è¯´ï¼ŒReactçœ‹åˆ°åœ¨ä¸åŒçš„æµè§ˆå™¨å’Œå¹³å°ä¸Šï¼Œç”¨æˆ·ç•Œé¢ä¸Šçš„äº‹ä»¶å…¶å®éå¸¸ç›¸ä¼¼ï¼Œä¾‹å¦‚æ™®é€šçš„`click`ï¼Œ`change`ç­‰ç­‰ã€‚Reactå¸Œæœ›é€šè¿‡å°è£…ä¸€å±‚äº‹ä»¶ç³»ç»Ÿï¼Œå°†ä¸åŒå¹³å°çš„åŸç”Ÿäº‹ä»¶éƒ½å°è£…æˆ`SyntheticEvent`ã€‚

- ä½¿å¾—**ä¸åŒå¹³å°åªéœ€è¦é€šè¿‡åŠ å…¥EventEmitterä»¥åŠå¯¹åº”çš„Rendererå°±èƒ½ä½¿ç”¨ç›¸åŒçš„ä¸€ä¸ªäº‹ä»¶ç³»ç»Ÿ**ï¼ŒWEBå¹³å°ä¸ŠåŠ å…¥`ReactBrowserEventEmitter`ï¼ŒNativeä¸ŠåŠ å…¥`ReactNativeEventEmitter`ã€‚å¦‚ä¸‹å›¾ï¼Œå¯¹äºä¸åŒå¹³å°ï¼ŒReactåªéœ€è¦æ›¿æ¢æ‰å·¦è¾¹éƒ¨åˆ†ï¼Œè€Œå³è¾¹`EventPluginHub`éƒ¨åˆ†å¯ä»¥ä¿æŒå¤ç”¨ã€‚
- è€Œ**å¯¹äºä¸åŒçš„æµè§ˆå™¨è€Œè¨€ï¼ŒReactå¸®æˆ‘ä»¬ç»Ÿä¸€äº†äº‹ä»¶ï¼Œåšäº†æµè§ˆå™¨çš„å…¼å®¹**ï¼Œä¾‹å¦‚å¯¹äº`transitionEnd`,`webkitTransitionEnd`,`MozTransitionEnd`å’Œ`oTransitionEnd`, Reactéƒ½ä¼šé›†åˆæˆ`topAnimationEnd`ï¼Œæ‰€ä»¥æˆ‘ä»¬åªç”¨å¤„ç†è¿™ä¸€ä¸ªæ ‡å‡†çš„äº‹ä»¶å³å¯ã€‚

![reactäº‹ä»¶ppt.005](https://qncdnssl.lzane.com/2018-11-04-react%E4%BA%8B%E4%BB%B6ppt.005.jpeg)

ç®€å•è€Œè¨€ï¼Œå°±ä¸jQueryå¸®åŠ©æˆ‘ä»¬è§£å†³äº†ä¸åŒæµè§ˆå™¨ä¹‹é—´çš„å…¼å®¹é—®ä¸€æ ·ï¼ŒReactæ›´è¿›ä¸€æ­¥ï¼Œè¿˜å¸®æˆ‘ä»¬ç»Ÿä¸€äº†ä¸åŒå¹³å°çš„å…¼å®¹ï¼Œä½¿æˆ‘ä»¬åœ¨å¼€å‘çš„æ—¶å€™åªéœ€è¦è€ƒè™‘æ ‡å‡†åŒ–çš„äº‹ä»¶å³å¯ã€‚

## Reactçš„äº‹ä»¶ç³»ç»Ÿæ˜¯æ€ä¹ˆè¿ä½œèµ·æ¥çš„ï¼Ÿ

### äº‹ä»¶ç»‘å®š

æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹æˆ‘ä»¬åœ¨JSXä¸­å†™çš„`onClick`handleræ˜¯æ€ä¹ˆè¢«è®°å½•åˆ°DOMç»“ç‚¹ä¸Šï¼Œå¹¶ä¸”åœ¨`document`ä¸Šåšç›‘å¬çš„ã€‚

![](https://qncdnssl.lzane.com/2018-11-04-15413164011795.jpg)

Reactå¯¹äºå¤§éƒ¨åˆ†äº‹ä»¶çš„ç»‘å®šéƒ½æ˜¯ä½¿ç”¨`trapBubbledEvent`å’Œ`trapCapturedEvent`è¿™ä¸¤ä¸ªå‡½æ•°æ¥æ³¨å†Œçš„ã€‚å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œå½“æˆ‘ä»¬æ‰§è¡Œäº†`render`æˆ–è€…`setState`ä¹‹åï¼ŒReactçš„Fiberè°ƒåº¦ç³»ç»Ÿä¼šåœ¨æœ€åcommitåˆ°DOMæ ‘ä¹‹å‰æ‰§è¡Œ`trapBubbledEven`æˆ–`trapCapturedEvent`ï¼Œ
é€šè¿‡æ‰§è¡Œ`addEventListener`åœ¨documentç»“ç‚¹ä¸Šç»‘å®šå¯¹åº”çš„`dispatch`ä½œä¸ºhandlerè´Ÿè´£ç›‘å¬ç±»å‹ä¸º`topLevelType`çš„äº‹ä»¶ã€‚

è¿™é‡Œé¢çš„`dispatchInteractiveEvent`å’Œ`dispatchEvent`ä¸¤ä¸ªå›è°ƒå‡½æ•°çš„åŒºåˆ«ä¸ºï¼ŒReact16å¼€å§‹æ¢æ‰äº†åŸæœ¬Stack ReconciliationæˆFiberå¸Œæœ›å®ç°å¼‚æ­¥æ¸²æŸ“ï¼ˆç›®å‰ä»æœªé»˜è®¤æ‰“å¼€ï¼Œä»éœ€ä½¿ç”¨`unstable_`å¼€å¤´çš„apiï¼Œæ­¤ç‰¹æ€§ä¸ä¾‹å­2æœ‰å…³ï¼Œå°†åœ¨[æ–‡ç« æœ€åé…å›¾è§£é‡Š](#é¢å¤–å¤šè¯´ä¸€ä¸ªç‚¹-setstateæ˜¯å¼‚æ­¥çš„)ï¼‰ï¼Œæ‰€ä»¥å¼‚æ­¥æ¸²æŸ“çš„æƒ…å†µä¸‹åŠ å…¥æˆ‘ç‚¹äº†ä¸¤æ¬¡æŒ‰é’®ï¼Œé‚£ä¹ˆç¬¬äºŒæ¬¡æŒ‰é’®å“åº”çš„æ—¶å€™ï¼Œå¯èƒ½ç¬¬ä¸€æ¬¡æŒ‰é’®çš„handlerAä¸­è°ƒç”¨çš„`setState`è¿˜æœªæœ€ç»ˆè¢«commitåˆ°DOMæ ‘ä¸Šï¼Œè¿™æ—¶éœ€è¦æŠŠç¬¬ä¸€æ¬¡æŒ‰é’®çš„ç»“æœå…ˆç»™flushæ‰å¹¶commitåˆ°DOMæ ‘ï¼Œæ‰èƒ½å¤Ÿä¿æŒä¸€è‡´æ€§ã€‚è¿™ä¸ªæ—¶å€™å°±ä¼šç”¨åˆ°`dispatchInteractiveEvent`ã€‚å¯ä»¥ç†è§£æˆ`dispatchInteractiveEvent`åœ¨æ‰§è¡Œå‰éƒ½ä¼šç¡®ä¿ä¹‹å‰æ‰€æœ‰æ“ä½œéƒ½å·²æœ€æ€»commitåˆ°DOMæ ‘ï¼Œå†å¼€å§‹è‡ªå·±çš„æµç¨‹ï¼Œå¹¶æœ€ç»ˆè§¦å‘`dispatchEvent`ã€‚ä½†ç”±äºç›®å‰Reactä»æ˜¯åŒæ­¥æ¸²æŸ“çš„ï¼Œæ‰€ä»¥è¿™ä¸¤ä¸ªå‡½æ•°åœ¨ç›®å‰çš„è¡¨ç°æ˜¯ä¸€è‡´çš„ï¼Œå¸Œæœ›React17ä¼šå¸¦ç»™æˆ‘ä»¬é»˜è®¤æ‰“å¼€çš„å¼‚æ­¥æ¸²æŸ“åŠŸèƒ½ã€‚

åˆ°ç°åœ¨æˆ‘ä»¬å·²ç»åœ¨documentç»“ç‚¹ä¸Šç›‘å¬äº†äº‹ä»¶äº†ï¼Œç°åœ¨éœ€è¦æ¥çœ‹å¦‚ä½•å°†æˆ‘ä»¬åœ¨jsxä¸­å†™çš„handlerå­˜èµ·æ¥å¯¹åº”åˆ°ç›¸åº”çš„ç»“ç‚¹ä¸Šã€‚

åœ¨æˆ‘ä»¬æ¯æ¬¡æ–°å»ºæˆ–è€…æ›´æ–°ç»“ç‚¹æ—¶ï¼ŒReactæœ€ç»ˆä¼šè°ƒç”¨`createInstance`æˆ–è€…`commitUpdate`è¿™ä¸¤ä¸ªå‡½æ•°ï¼Œè€Œè¿™ä¸¤ä¸ªå‡½æ•°éƒ½ä¼šæœ€ç»ˆè°ƒç”¨`updateFiberProps`è¿™ä¸ªå‡½æ•°ï¼Œå°†`props`ä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„`onClick`ï¼Œ`onChange`ç­‰handlerç»™å­˜åˆ°DOMç»“ç‚¹ä¸Šã€‚

è‡³æ­¤ï¼Œæˆ‘ä»¬æˆ‘ä»¬å·²ç»åœ¨documentä¸Šç›‘å¬äº†äº‹ä»¶ï¼Œå¹¶ä¸”å°†handlerå­˜åœ¨å¯¹åº”DOMç»“ç‚¹ã€‚æ¥ä¸‹æ¥éœ€è¦çœ‹Reactæ€ä¹ˆç›‘å¬å¹¶å¤„ç†æµè§ˆå™¨çš„åŸç”Ÿäº‹ä»¶ï¼Œæœ€ç»ˆè§¦å‘å¯¹åº”çš„handleräº†ã€‚

### äº‹ä»¶è§¦å‘

è¿™é‡Œæˆ‘åšäº†ä¸ªåŠ¨ç”»ï¼Œå¸Œæœ›èƒ½å¤Ÿå¯¹ä½ ä»¬ç†è§£æœ‰å¸®åŠ©ã€‚ç‚¹å‡»ç»¿è‰²çš„æŒ‰é’®>æ’­æ”¾ä¸‹ä¸€æ­¥ã€‚

<iframe src="https://www.lzane.com/animate/react-event-system/index.html" style="border:0; width:100%; height:500px; overflow:hidden"></iframe>

ä»¥ç®€å•çš„`click`äº‹ä»¶ä¸ºä¾‹ï¼Œé€šè¿‡äº‹ä»¶ç»‘å®šæˆ‘ä»¬å·²ç»åœ¨`document`ä¸Šç›‘å¬äº†`click`äº‹ä»¶ï¼Œå½“æˆ‘ä»¬çœŸæ­£ç‚¹å‡»äº†è¿™ä¸ªæŒ‰é’®çš„æ—¶å€™ï¼ŒåŸç”Ÿçš„äº‹ä»¶æ˜¯å¦‚ä½•è¿›å…¥Reactçš„ç®¡è¾–èŒƒå›´çš„ï¼Ÿå¦‚ä½•åˆæˆ`SyntheticEvent`ä»¥åŠå¦‚ä½•æ¨¡æ‹Ÿæ•è·å’Œå†’æ³¡çš„ï¼Ÿä»¥åŠæœ€åæˆ‘ä»¬åœ¨jsxä¸­å†™çš„`onClick`handleræ˜¯å¦‚ä½•è¢«æœ€ç»ˆè§¦å‘çš„ï¼Ÿå¸¦ç€è¿™äº›é—®é¢˜ï¼Œæˆ‘ä»¬ä¸€èµ·æ¥çœ‹ä¸€ä¸‹äº‹ä»¶è§¦å‘é˜¶æ®µã€‚

æˆ‘ä¼šå¤§æ¦‚ç”¨ä¸‹å›¾è¿™ç§æ–¹å¼æ¥è§£æä»£ç ï¼Œå·¦è¾¹æ˜¯æˆ‘ç‚¹å‡»ä¸€ä¸ªç»‘å®šäº†`handleClick`çš„æŒ‰é’®åçš„jsè°ƒç”¨æ ˆï¼Œå³è¾¹æ˜¯æ¯ä¸€æ­¥çš„ä»£ç ï¼Œå‡å·²åˆ é™¤éƒ¨åˆ†ä¸å½±å“ç†è§£çš„ä»£ç ã€‚å¸Œæœ›é€šè¿‡è¿™ç§æ–¹å¼èƒ½ä½¿å¤§å®¶æ›´æ˜“ç†è§£Reactçš„äº‹ä»¶è§¦å‘æœºåˆ¶ã€‚

![](https://qncdnssl.lzane.com/2018-11-04-15413164315532.jpg)

å½“æˆ‘ä»¬ç‚¹å‡»ä¸€ä¸ªæŒ‰é’®æ˜¯ï¼Œ`click`äº‹ä»¶å°†ä¼šæœ€ç»ˆå†’æ³¡è‡³documentï¼Œå¹¶è§¦å‘æˆ‘ä»¬ç›‘å¬åœ¨documentä¸Šçš„handler `dispatchEvent`ï¼Œæ¥ç€è§¦å‘`batchedUpdates`ã€‚`batchedUpdates`è¿™ä¸ªæ ¼å¼çš„ä»£ç åœ¨Reactçš„æºç é‡Œé¢ä¼šé¢‘ç¹çš„å‡ºç°ï¼ŒåŸºæœ¬ä¸ŠReactå°†æ‰€æœ‰èƒ½å¤Ÿ**æ‰¹é‡å¤„ç†**çš„äº‹æƒ…éƒ½ä¼šå…ˆæ”¶é›†èµ·æ¥ï¼Œå†ä¸€æ¬¡æ€§å¤„ç†ã€‚

å¯ä»¥çœ‹åˆ°é»˜è®¤çš„`isBatching`æ˜¯falseçš„ï¼Œå½“è°ƒç”¨äº†ä¸€æ¬¡`batchedUpdates`ï¼Œ`isBatching`çš„å€¼å°†ä¼šå˜æˆtrueï¼Œæ­¤æ—¶å¦‚æœåœ¨æ¥ä¸‹æ¥çš„è°ƒç”¨ä¸­æœ‰ç»§ç»­è°ƒç”¨`batchedUpdates`çš„è¯ï¼Œå°±ä¼šç›´æ¥æ‰§è¡Œ`handleTopLevel`,æ­¤æ—¶çš„`setState`ç­‰ä¸ä¼šè¢«æ›´æ–°åˆ°DOMä¸Šã€‚ç›´åˆ°è°ƒç”¨æ ˆé‡æ–°å›åˆ°ç¬¬ä¸€æ¬¡è°ƒç”¨`batchedUpdates`çš„æ—¶å€™ï¼Œæ‰ä¼šå°†æ‰€æœ‰ç»“æœä¸€èµ·flushæ‰ï¼ˆæ›´æ–°åˆ°DOMä¸Šï¼‰ã€‚

![](https://qncdnssl.lzane.com/2018-11-04-15413175673832.jpg)

æœ‰çš„åŒå­¦å¯èƒ½é—®è°ƒç”¨æ ˆä¸­çš„`BatchedUpdates$1`æ˜¯ä»€ä¹ˆï¼Ÿæˆ–è€…æµè§ˆå™¨çš„rendererå’ŒNativeçš„rendereræ˜¯å¦‚æœæŒ‚åœ¨åˆ°Reactçš„äº‹ä»¶ç³»ç»Ÿä¸Šçš„?

å…¶å®Reactäº‹ä»¶ç³»ç»Ÿé‡Œé¢æä¾›äº†ä¸€ä¸ªå‡½æ•°`setBatchingImplementation`ï¼Œç”¨æ¥åŠ¨æ€æŒ‚è½½ä¸åŒå¹³å°çš„rendererï¼Œè¿™ä¸ªä¹Ÿä½“ç°äº†Reactäº‹ä»¶ç³»ç»Ÿçš„`å¤ç”¨`ã€‚

è¿™é‡Œçš„`interactiveUpdates`å’Œ`batchedUpdates`çš„åŒºåˆ«åœ¨ä¸Šæ–‡å·²ç»è§£é‡Šè¿‡ï¼Œè¿™é‡Œå°±ä¸å†èµ˜è¿°ã€‚

![](https://qncdnssl.lzane.com/2018-11-04-15413164501870.jpg)

`handleTopLevel`ä¼šè°ƒç”¨`runExtractedEventsInBatch()`ï¼Œè¿™æ˜¯Reactäº‹ä»¶å¤„ç†æœ€é‡è¦çš„å‡½æ•°ã€‚å¦‚ä¸Šé¢åŠ¨ç”»æˆ‘ä»¬çœ‹åˆ°çš„ï¼Œåœ¨`EventEmitter`é‡Œé¢åšçš„äº‹ï¼Œå…¶å®ä¸»è¦å°±æ˜¯è¿™ä¸ªå‡½æ•°çš„ä¸¤æ­¥ã€‚

- **ç¬¬ä¸€æ­¥æ˜¯æ ¹æ®åŸç”Ÿäº‹ä»¶åˆæˆåˆæˆäº‹ä»¶ï¼Œå¹¶ä¸”åœ¨vDOMä¸Šæ¨¡æ‹Ÿæ•è·å†’æ³¡ï¼Œæ”¶é›†æ‰€æœ‰éœ€è¦æ‰§è¡Œçš„äº‹ä»¶å›è°ƒæ„æˆå›è°ƒæ•°ç»„ã€‚**
- **ç¬¬äºŒæ­¥æ˜¯éå†å›è°ƒæ•°ç»„ï¼Œè§¦å‘å›è°ƒå‡½æ•°ã€‚**

![](https://qncdnssl.lzane.com/2018-11-04-15413164560026.jpg)

é¦–å…ˆè°ƒç”¨`extractEvents`ï¼Œä¼ å…¥åŸç”Ÿäº‹ä»¶`e`ï¼ŒReactäº‹ä»¶ç³»ç»Ÿæ ¹æ®å¯èƒ½çš„äº‹ä»¶æ’ä»¶åˆæˆåˆæˆäº‹ä»¶`Synthetic e`ã€‚ è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°è°ƒç”¨äº†`EventConstructor.getPooled()`ï¼Œä»äº‹ä»¶æ± ä¸­å»å–ä¸€ä¸ªåˆæˆäº‹ä»¶å¯¹è±¡ï¼Œå¦‚æœäº‹ä»¶æ± ä¸ºç©ºï¼Œåˆ™æ–°åˆ›å»ºä¸€ä¸ªåˆæˆäº‹ä»¶å¯¹è±¡ï¼Œè¿™ä½“ç°äº†Reactä¸ºäº†æ€§èƒ½å®ç°äº†**æ± **çš„æ€æƒ³ã€‚

![](https://qncdnssl.lzane.com/2018-11-04-15413164608984.jpg)

ç„¶åä¼ å…¥Propagatorï¼Œåœ¨vDOMä¸Šæ¨¡æ‹Ÿæ•è·å’Œå†’æ³¡ï¼Œå¹¶æ”¶é›†æ‰€æœ‰éœ€è¦æ‰§è¡Œçš„äº‹ä»¶å›è°ƒå’Œå¯¹åº”çš„ç»“ç‚¹ã€‚`traverseTwoPhase`æ¨¡æ‹Ÿäº†æ•è·å’Œå†’æ³¡çš„ä¸¤ä¸ªé˜¶æ®µï¼Œè¿™é‡Œå®ç°å¾ˆå·§å¦™ï¼Œç®€å•è€Œè¨€å°±æ˜¯æ­£å‘å’Œåå‘éå†äº†ä¸€ä¸‹æ•°ç»„ã€‚æ¥ç€å¯¹æ¯ä¸€ä¸ªç»“ç‚¹ï¼Œè°ƒç”¨`listenerAtPhase`å–å‡ºäº‹ä»¶ç»‘å®šæ—¶æŒ‚è½½åœ¨ç»“ç‚¹ä¸Šçš„å›è°ƒå‡½æ•°ï¼ŒæŠŠå®ƒåŠ å…¥å›è°ƒæ•°ç»„ä¸­ã€‚

![](https://qncdnssl.lzane.com/2018-11-04-15413164659157.jpg)

æ¥ç€éå†æ‰€æœ‰åˆæˆäº‹ä»¶ã€‚è¿™é‡Œå¯ä»¥çœ‹åˆ°å½“ä¸€ä¸ªäº‹ä»¶å¤„ç†å®Œçš„æ—¶å€™ï¼ŒReactä¼šè°ƒç”¨`event.isPersistent()`æ¥æŸ¥çœ‹è¿™ä¸ªåˆæˆäº‹ä»¶æ˜¯å¦éœ€è¦è¢«æŒä¹…åŒ–ï¼Œå¦‚æœä¸éœ€è¦å°±ä¼šé‡Šæ”¾è¿™ä¸ªåˆæˆäº‹ä»¶ï¼Œè¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆå½“æˆ‘ä»¬éœ€è¦å¼‚æ­¥è¯»å–æ“ä½œä¸€ä¸ªåˆæˆäº‹ä»¶çš„æ—¶å€™ï¼Œéœ€è¦æ‰§è¡Œ`event.persist()`ï¼Œä¸ç„¶Reactå°±æ˜¯åœ¨è¿™é‡Œé‡Šæ”¾æ‰è¿™ä¸ªäº‹ä»¶ã€‚

![](https://qncdnssl.lzane.com/2018-11-04-15413164725789.jpg)

æœ€åè¿™é‡Œå°±æ˜¯å›è°ƒå‡½æ•°è¢«çœŸæ­£è§¦å‘çš„æ—¶å€™äº†ï¼Œå–å‡ºå›è°ƒæ•°ç»„`event._dispatchListeners`ï¼Œéå†è§¦å‘å›è°ƒå‡½æ•°ã€‚å¹¶é€šè¿‡`event.isPropagationStopped()`è¿™ä¸€æ­¥æ¥æ¨¡æ‹Ÿåœæ­¢å†’æ³¡ã€‚è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒReactåœ¨æ”¶é›†å›è°ƒæ•°ç»„çš„æ—¶å€™å¹¶ä¸ä¼šå»ç®¡æˆ‘ä»¬æ˜¯å¦è°ƒç”¨äº†`stopPropagation`ï¼Œè€Œæ˜¯ä¼šåœ¨è§¦å‘çš„é˜¶æ®µæ‰ä¼šå»æ£€æŸ¥æ˜¯å¦éœ€è¦åœæ­¢å†’æ³¡ã€‚

è‡³æ­¤ï¼Œä¸€ä¸ªäº‹ä»¶å›è°ƒå‡½æ•°å°±è¢«è§¦å‘äº†ï¼Œé‡Œé¢å¦‚æœæ‰§è¡Œäº†`setState`ç­‰å°±ä¼šç­‰åˆ°è°ƒç”¨æ ˆå¼¹å›åˆ°æœ€ä½éƒ¨çš„`interactiveUpdate`ä¸­çš„è¢«æœ€ç»ˆflushæ‰ï¼Œæ„é€ vDOMï¼Œå’Œå¥½ï¼Œå¹¶æœ€ç»ˆè¢«commitåˆ°DOMä¸Šã€‚

è¿™å°±æ˜¯äº‹ä»¶è§¦å‘çš„æ•´ä¸ªè¿‡ç¨‹äº†ï¼Œå¯ä»¥å›å»å†çœ‹ä¸€ä¸‹[åŠ¨ç”»](#äº‹ä»¶è§¦å‘)ï¼Œç›¸ä¿¡ä½ ä¼šæ›´åŠ ç†è§£è¿™ä¸ªè¿‡ç¨‹çš„ã€‚

## ä¾‹å­Debug

ç°åœ¨æˆ‘ä»¬å¯¹Reactäº‹ä»¶ç³»ç»Ÿå·²ç»æ¯”è¾ƒç†Ÿæ‚‰äº†ï¼Œå›åˆ°æ–‡ç« å¼€å¤´çš„é‚£ä¸¤ä¸ªç„å­¦é—®é¢˜ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹åˆ°åº•ä¸ºä»€ä¹ˆ?

### ä¾‹å­ä¸€

> å¦‚æœæƒ³çœ‹é¢˜ç›®å†…å®¹æˆ–è€…å¿˜è®°é¢˜ç›®äº†ï¼Œå¯ä»¥ç‚¹å‡»[è¿™é‡Œ](#ä¾‹å­ä¸€)æŸ¥çœ‹ã€‚

ç›¸ä¿¡çœ‹å®Œè¿™ç¯‡æ–‡ç« ï¼Œå¦‚æœä½ å·²ç»å¯¹Reactäº‹ä»¶ç³»ç»Ÿæœ‰æ‰€ç†è§£ï¼Œè¿™é“é¢˜åº”è¯¥æ˜¯ä¸éš¾äº†ã€‚

1. å› ä¸ºReactäº‹ä»¶ç›‘å¬æ˜¯æŒ‚è½½åœ¨documentä¸Šçš„ï¼Œæ‰€ä»¥åŸç”Ÿç³»ç»Ÿåœ¨`#outer`ä¸Šç›‘å¬çš„å›è°ƒ`B`ä¼šæœ€å…ˆè¢«æ‰§è¡Œï¼›æ¥ç€åŸç”Ÿäº‹ä»¶å†’æ³¡è‡³documentè¿›å…¥Reactäº‹ä»¶ç³»ç»Ÿï¼ŒReactäº‹ä»¶ç³»ç»Ÿæ¨¡æ‹Ÿæ•è·å†’æ³¡è¾“å‡º`A`å’Œ`B`ï¼›æœ€åReactäº‹ä»¶ç³»ç»Ÿæ‰§è¡Œå®Œæ¯•å›åˆ°æµè§ˆå™¨ç»§ç»­å†’æ³¡åˆ°windowï¼Œè¾“å‡º`D`ã€‚
2. åŸç”Ÿç³»ç»Ÿåœ¨`#outer`ä¸Šç›‘å¬çš„å›è°ƒ`B`ä¼šæœ€å…ˆè¢«æ‰§è¡Œï¼›æ¥ç€åŸç”Ÿäº‹ä»¶å†’æ³¡è‡³documentè¿›å…¥Reactäº‹ä»¶ç³»ç»Ÿï¼Œåœ¨Reactäº‹ä»¶å¤„ç†ä¸­`#inner`è°ƒç”¨äº†`stopPropagation`ï¼Œäº‹ä»¶è¢«åœæ­¢å†’æ³¡ã€‚

æ‰€ä»¥ï¼Œæœ€å¥½**ä¸è¦æ··ç”¨Reactäº‹ä»¶ç³»ç»Ÿå’ŒåŸç”Ÿäº‹ä»¶ç³»ç»Ÿ**ï¼Œå¦‚æœæ··ç”¨äº†ï¼Œè¯·ä¿è¯ä½ æ¸…æ¥šçŸ¥é“ä¼šå‘ç”Ÿä»€ä¹ˆã€‚

### ä¾‹å­äºŒ

> å¦‚æœæƒ³çœ‹é¢˜ç›®å†…å®¹æˆ–è€…å¿˜è®°é¢˜ç›®äº†ï¼Œå¯ä»¥ç‚¹å‡»[è¿™é‡Œ](#ä¾‹å­äºŒ)æŸ¥çœ‹ã€‚

è¿™ä¸ªé—®é¢˜å°±ç¨å¾®å¤æ‚ä¸€ç‚¹ã€‚é¦–å…ˆæˆ‘ä»¬ç‚¹å‡»`edit`æŒ‰é’®æµè§ˆå™¨è§¦å‘ä¸€ä¸ª`click`äº‹ä»¶ï¼Œå†’æ³¡è‡³documentè¿›å…¥Reactäº‹ä»¶ç³»ç»Ÿï¼ŒReactæ‰§è¡Œå›è°ƒè°ƒç”¨`setState`ï¼Œæ­¤æ—¶Reactäº‹ä»¶ç³»ç»Ÿå¯¹äº‹ä»¶çš„å¤„ç†æ‰§è¡Œå®Œæ¯•ã€‚ç”±äºç›®å‰Reactæ˜¯åŒæ­¥æ¸²æŸ“çš„ï¼Œæ‰€ä»¥æ¥ç€Reactæ‰§è¡Œ`performSyncWork`å°†è¯¥buttonæ”¹æˆ`type="submit"`ï¼Œç”±äºåŒä¸ªä½ç½®çš„ç»“ç‚¹å¹¶ä¸”tagéƒ½ä¸ºbuttonï¼Œæ‰€ä»¥Reactå¤ç”¨äº†è¿™ä¸ªbuttonç»“ç‚¹[^react_reconciliation]ï¼Œå¹¶æ›´æ–°åˆ°DOMä¸Šã€‚æ­¤æ—¶æµè§ˆå™¨å¯¹`click`äº‹ä»¶æ‰§è¡Œç»§ç»­ï¼Œå…¶å‘ç°è¯¥ç»“ç‚¹çš„`type="submit"`ï¼Œåˆ™è§¦å‘`submit`äº‹ä»¶ã€‚

è§£å†³çš„åŠæ³•å°±æœ‰å¾ˆå¤šç§äº†ï¼Œç»™buttonåŠ ä¸Š`key`ï¼›ä¸¤ä¸ªæŒ‰é’®åˆ†å¼€å†™ï¼Œä¸è¦ç”¨ä¸‰å…ƒç­‰éƒ½å¯ä»¥è§£å†³é—®é¢˜ã€‚

å…·ä½“å¯ä»¥çœ‹ä¸€ä¸‹ä¸‹é¢çš„è¿™ä¸ªè°ƒç”¨å›¾ï¼Œåº”è¯¥ä¹Ÿå¾ˆå¥½ç†è§£ï¼Œå¦‚æœæœ‰ä¸èƒ½ç†è§£çš„åœ°æ–¹ï¼Œè¯·åœ¨ä¸‹é¢ç•™è¨€ï¼Œæˆ‘ä¼šå°½æˆ‘æ‰€èƒ½è§£é‡Šæ¸…æ¥šã€‚

![](https://qncdnssl.lzane.com/2018-11-04-15413164911702.jpg)

-----------

#### é¢å¤–å¤šè¯´ä¸€ä¸ªç‚¹ï¼Œâ€œsetStateæ˜¯å¼‚æ­¥çš„â€

ç›¸ä¿¡å¯¹äºå¾ˆå¤šReactå¼€å‘è€…æ¥è¯´ï¼Œâ€œsetStateæ˜¯å¼‚æ­¥çš„â€è¿™å¥è¯åº”è¯¥ç»å¸¸å¬åˆ°ï¼Œæˆ‘è®°å¾—æˆ‘ä¸€å¼€å§‹å­¦ä¹ Reactçš„æ—¶å€™ç»å¸¸å°±ä¼šçœ‹åˆ°è¿™å¥è¯ï¼Œç„¶åè¯´å¦‚æœéœ€è¦ç”¨åˆ°ä¹‹å‰çš„stateéœ€è¦åœ¨setStateä¸­é‡‡ç”¨`setState((preState)=>{})`è¿™æ ·çš„æ–¹å¼ã€‚

ä½†å…¶å®è¿™å¥è¯å¹¶ä¸æ˜¯å®Œå…¨å‡†ç¡®çš„ã€‚å‡†ç¡®çš„è¯´æ³•åº”è¯¥æ˜¯**setStateæœ‰æ—¶å€™æ˜¯å¼‚æ­¥çš„ï¼ŒsetStateç›¸å¯¹äºæµè§ˆå™¨è€Œè¨€æ˜¯åŒæ­¥çš„**

ç›®å‰è€Œè¨€`setState`åœ¨ç”Ÿå‘½å‘¨æœŸä»¥åŠäº‹ä»¶å›è°ƒä¸­æ˜¯å¼‚æ­¥çš„ï¼Œä¹Ÿå°±æ˜¯ä¼šæ”¶é›†èµ·æ¥æ‰¹é‡å¤„ç†ã€‚åœ¨å…¶å®ƒæƒ…å†µä¸‹å¦‚promiseï¼ŒsetTimeoutä¸­éƒ½æ˜¯åŒæ­¥æ‰§è¡Œçš„ï¼Œä¹Ÿå°±æ˜¯è°ƒç”¨ä¸€æ¬¡setStateå°±ä¼šrenderä¸€æ¬¡å¹¶æ›´æ–°åˆ°DOMä¸Šé¢ï¼Œä¸ä¿¡çš„è¯å¯ä»¥ç‚¹å‡»[è¿™é‡Œ](https://codesandbox.io/s/pyqmrx516x)å°è¯•ã€‚

ä¸”åœ¨JSè°ƒç”¨æ ˆè¢«å¼¹ç©ºæ—¶å€™ï¼Œå¿…å®šæ˜¯å·²ç»å°†ç»“æœæ›´æ–°åˆ°DOMä¸Šé¢äº†ï¼ˆåŒæ­¥æ¸²æŸ“ï¼‰ã€‚è¿™ä¹Ÿå°±æ˜¯setStateç›¸å¯¹äºæµè§ˆå™¨æ˜¯åŒæ­¥çš„å«ä¹‰ã€‚å¦‚ä¸‹å›¾æ‰€ç¤º

![](https://qncdnssl.lzane.com/2018-11-04-15413204706161.jpg)

å¼‚æ­¥æ¸²æŸ“çš„æµç¨‹å›¾å¤§æ¦‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæœ€è¿‘ä¸€æ¬¡æ€è€ƒè¿™ä¸ªé—®é¢˜çš„æ—¶å€™ï¼Œå‘ç°å¦‚æœç°åœ¨æ˜¯å¼‚æ­¥æ¸²æŸ“çš„è¯ï¼Œé‚£æˆ‘ä»¬çš„ä¾‹å­äºŒå°†å˜æˆå¶ç°çš„å‘ğŸ˜‚ï¼Œå› ä¸ºå¦‚æœ`setState`çš„ç»“æœè¿˜æ²¡è¢«æ›´æ–°åˆ°DOMä¸Šï¼Œæµè§ˆå™¨å°±ä¸ä¼šè§¦å‘submitäº‹ä»¶ã€‚

![](https://qncdnssl.lzane.com/2018-11-04-15413165006172.jpg)

ä¸è¿‡Reactå›¢é˜Ÿå·²ç»ä¸ºå¼‚æ­¥æ¸²æŸ“çš„æ„¿æ™¯å¼€å‘äº†ä¸¤å¹´ï¼Œä¸”React16ä¸­å·²ç»é‡‡ç”¨äº†Fiber reconciliationå’Œæä¾›äº†å¼‚æ­¥æ¸²æŸ“çš„api `unstable_xxx`ï¼Œç›¸ä¿¡åœ¨React17ä¸­æˆ‘ä»¬å¯ä»¥äº«å—åˆ°å¼‚æ­¥æ¸²æŸ“å¸¦æ¥çš„æ€§èƒ½æå‡ï¼Œæ„Ÿè°¢Reactå›¢é˜Ÿã€‚


## æ€»ç»“
å¸Œæœ›è¯»å®Œæ­¤æ–‡ï¼Œèƒ½è®©ä½ Reactäº‹ä»¶ç³»ç»Ÿæœ‰ä¸ªç®€å•çš„è®¤è¯†ã€‚çŸ¥é“â€œä¸ºä»€ä¹ˆReactéœ€è¦è‡ªå·±å®ç°ä¸€å¥—äº‹ä»¶ç³»ç»Ÿï¼Ÿâ€å’Œâ€œReactçš„äº‹ä»¶ç³»ç»Ÿæ˜¯æ€ä¹ˆè¿ä½œèµ·æ¥çš„ï¼Ÿâ€ã€‚Reactä¸ºäº†**æ€§èƒ½**å’Œ**å¤ç”¨**ï¼Œé‡‡ç”¨äº†äº‹ä»¶ä»£ç†ï¼Œæ± ï¼Œæ‰¹é‡æ›´æ–°ï¼Œè·¨æµè§ˆå™¨å’Œè·¨å¹³å°å…¼å®¹ç­‰æ€æƒ³ï¼Œå°†äº‹ä»¶ç›‘å¬æŒ‚è½½åœ¨documentä¸Šï¼Œå¹¶ä¸”æ„é€ åˆæˆäº‹ä»¶ï¼Œå¹¶ä¸”åœ¨å†…éƒ¨æ¨¡æ‹Ÿäº†ä¸€å¥—æ•è·å’Œå†’æ³¡å¹¶è§¦å‘å›è°ƒå‡½æ•°çš„æœºåˆ¶ï¼Œå®ç°äº†è‡ªå·±ä¸€å¥—äº‹ä»¶ç³»ç»Ÿã€‚

å¦‚æœä½ è¿˜æœ‰å“ªé‡Œä¸æ¸…æ¥šï¼Œå‘ç°æ–‡ç« æœ‰é”™æ¼ï¼Œæˆ–æ˜¯å•çº¯çš„äº¤æµç›¸å…³é—®é¢˜ï¼Œè¯·åœ¨ä¸‹é¢ç•™è¨€ï¼Œæˆ‘ä¼šå°½æˆ‘æ‰€èƒ½å›å¤å’Œè§£ç­”ä½ çš„ç–‘é—®çš„ã€‚ å¦‚æœä½ å–œæ¬¢æˆ‘çš„æ–‡ç« ï¼Œè¯·å…³æ³¨æˆ‘å’Œæˆ‘çš„åšå®¢ï¼Œè°¢è°¢ã€‚

## Read More & Reference
- [æ¨èï¼React events in depth w/ Kent C. Dodds, Ben Alpert, & Dan Abramov](https://www.youtube.com/watch?v=dRo_egw7tBc&t=8s) 
- [æ¨èï¼The React and React Native Event System Explained: A Harmonious Coexistence](https://levelup.gitconnected.com/how-exactly-does-react-handles-events-71e8b5e359f2)
- [Didact Fiber: Incremental reconciliation](https://engineering.hexacta.com/didact-fiber-incremental-reconciliation-b2fe028dcaec)
- [Codebase Overview](https://reactjs.org/docs/codebase-overview.html)

[^propagation_document]:é™¤äº†å°‘æ•°ä¸ä¼šå†’æ³¡åˆ°documentçš„äº‹ä»¶ï¼Œä¾‹å¦‚videoç­‰ã€‚
[^react_reconciliation]:[å…·ä½“åŸå› å¯ä»¥å‚è€ƒ](https://reactjs.org/docs/reconciliation.html#motivation)


